Thu 15 Jan 2026 21:18:25 INFO ██Server: 	bronx
Thu 15 Jan 2026 21:18:25 INFO ██Dir: 	C:\Users\guanj\Dev\MMRec\src

Thu 15 Jan 2026 21:18:25 INFO 
gpu_id=0
use_gpu=True
seed=[999]
use_amp=True
keep_features_on_cpu=True
use_checkpoint=True
use_torch_compile=True
clip_grad_norm={'max_norm': 5.0, 'norm_type': 2}
data_path=../data/
inter_splitting_label=x_label
filter_out_cod_start_users=True
is_multimodal_model=True
checkpoint_dir=saved
save_recommended_topk=True
recommend_topk=recommend_topk/
embedding_size=64
weight_decay=0.0
req_training=True
epochs=200
stopping_step=20
train_batch_size=4096
learner=adam
learning_rate=[0.0001]
learning_rate_scheduler=[1.0, 50]
eval_step=1
training_neg_sample_num=1
use_neg_sampling=True
use_full_sampling=False
NEG_PREFIX=neg__
USER_ID_FIELD=userID
ITEM_ID_FIELD=itemID
TIME_FIELD=timestamp
field_separator=	
metrics=['Recall', 'NDCG', 'Precision', 'MAP']
topk=[20]
valid_metric=Recall@20
eval_batch_size=4096
use_candidate_sampling=True
candidate_sampling_type=popularity
num_negative_candidates=99
use_raw_features=False
max_txt_len=32
max_img_size=256
vocab_size=30522
type_vocab_size=2
hidden_size=4
pad_token_id=0
max_position_embeddings=512
layer_norm_eps=1e-12
hidden_dropout_prob=0.1
end2end=False
use_fettle=False
cf_extraction_method=average
iladt_weight=0.05
cla_weight=0.01
clcr_gamma=0.05
ga_gamma=0.1
prototype_num=10
hyper_parameters=['seed', 'aggr_mode', 'reg_weight', 'learning_rate']
inter_file_name=cs_lowcount_10/clean_lowcount_coldstart_interactions.csv
vision_feature_file=cs_lowcount_10/clean_audio_feat_mert.npy
text_feature_file=cs_lowcount_10/clean_text_feat.npy
user_graph_dict_file=user_graph_dict.npy
feat_embed_dim=64
n_mm_layers=1
n_layers=2
knn_k=10
mm_image_weight=0.1
aggr_mode=['add']
reg_weight=[0.001]
model=DRAGON
dataset=Music4All
valid_metric_bigger=True
device=cuda


Thu 15 Jan 2026 21:18:26 INFO Music4All
The number of users: 14127
Average actions of users: 294.72605648757695
The number of items: 99596
Average actions of items: 41.804841559902
The number of inters: 4163595
The sparsity of the dataset: 99.70407842033056%
Thu 15 Jan 2026 21:18:26 INFO 
====Training====
Music4All
The number of users: 14127
Average actions of users: 288.95342252424433
The number of items: 98431
Average actions of items: 41.47113206205362
The number of inters: 4082045
The sparsity of the dataset: 99.70644063097576%
Thu 15 Jan 2026 21:18:26 INFO 
====Validation====
Music4All
The number of users: 7491
Average actions of users: 5.262047790682152
The number of items: 23690
Average actions of items: 1.6639088222878853
The number of inters: 39418
The sparsity of the dataset: 99.97778789450958%
Thu 15 Jan 2026 21:18:26 INFO 
====Testing====
Music4All
The number of users: 7662
Average actions of users: 5.498825371965545
The number of items: 24618
Average actions of items: 1.7114306604923226
The number of inters: 42132
The sparsity of the dataset: 99.97766339519065%
Thu 15 Jan 2026 21:18:29 INFO 

=================================


Thu 15 Jan 2026 21:18:29 INFO =========1/1: Parameters:['seed', 'aggr_mode', 'reg_weight', 'learning_rate']=(999, 'add', 0.001, 0.0001)=======
Thu 15 Jan 2026 22:08:41 INFO DRAGON(
  (MLP_v): Linear(in_features=64, out_features=64, bias=False)
  (MLP_t): Linear(in_features=64, out_features=64, bias=False)
  (image_embedding): Embedding(99596, 1024)
  (image_trs): Linear(in_features=1024, out_features=64, bias=True)
  (text_embedding): Embedding(99596, 384)
  (text_trs): Linear(in_features=384, out_features=64, bias=True)
  (MLP_user): Linear(in_features=128, out_features=64, bias=True)
  (v_gcn): GCN(
    (MLP): Linear(in_features=1024, out_features=128, bias=True)
    (MLP_1): Linear(in_features=128, out_features=64, bias=True)
    (conv_embed_1): Base_gcn(64, 64)
  )
  (t_gcn): GCN(
    (MLP): Linear(in_features=384, out_features=128, bias=True)
    (MLP_1): Linear(in_features=128, out_features=64, bias=True)
    (conv_embed_1): Base_gcn(64, 64)
  )
  (user_graph): User_Graph_sample()
)
Trainable parameters: 142570550
Thu 15 Jan 2026 22:08:42 INFO Mixed Precision Training (FP16) enabled - expect ~40-50% memory reduction
Thu 15 Jan 2026 22:08:44 INFO ✅ Model compiled with torch.compile - expect ~20-30% speedup after first epoch
Thu 15 Jan 2026 22:08:44 INFO Initialized tot_item_num: 99596
Thu 15 Jan 2026 22:08:44 INFO Computing item popularity from training data...
Thu 15 Jan 2026 22:08:53 INFO Computed item popularity: 98431/99596 items in training
Thu 15 Jan 2026 22:08:53 INFO Smoothing parameter alpha=0.01, min_prob=2.45e-09, max_prob=1.66e-02
Thu 15 Jan 2026 22:15:46 INFO Epoch 0 training [time: 413.21s, Train loss: 237.1245]
Thu 15 Jan 2026 22:15:58 INFO Epoch 0: valid_score: 0.0478
Thu 15 Jan 2026 22:15:58 INFO Valid result: recall@20_full: 0.0000    ndcg@20_full: 0.0000    precision@20_full: 0.0000    map@20_full: 0.0000    recall@20_pop: 0.0478    ndcg@20_pop: 0.0291    precision@20_pop: 0.0229    map@20_pop: 0.0148    
Thu 15 Jan 2026 22:15:58 INFO Test result : recall@20_full: 0.0000    ndcg@20_full: 0.0000    precision@20_full: 0.0000    map@20_full: 0.0000    recall@20_pop: 0.0446    ndcg@20_pop: 0.0282    precision@20_pop: 0.0224    map@20_pop: 0.0147    
Thu 15 Jan 2026 22:15:58 INFO ██ DRAGON--Best validation results updated!!!
Thu 15 Jan 2026 22:22:51 INFO Epoch 1 training [time: 412.06s, Train loss: 174.8833]
Thu 15 Jan 2026 22:23:00 INFO Epoch 1: valid_score: 0.0735
Thu 15 Jan 2026 22:23:00 INFO Valid result: recall@20_pop: 0.0735    ndcg@20_pop: 0.0445    precision@20_pop: 0.0327    map@20_pop: 0.0230    
Thu 15 Jan 2026 22:23:00 INFO Test result : recall@20_pop: 0.0701    ndcg@20_pop: 0.0432    precision@20_pop: 0.0328    map@20_pop: 0.0225    
Thu 15 Jan 2026 22:23:00 INFO ██ DRAGON--Best validation results updated!!!
Thu 15 Jan 2026 22:29:53 INFO Epoch 2 training [time: 412.63s, Train loss: 159.9777]
Thu 15 Jan 2026 22:30:02 INFO Epoch 2: valid_score: 0.0832
Thu 15 Jan 2026 22:30:02 INFO Valid result: recall@20_pop: 0.0832    ndcg@20_pop: 0.0514    precision@20_pop: 0.0370    map@20_pop: 0.0277    
Thu 15 Jan 2026 22:30:02 INFO Test result : recall@20_pop: 0.0811    ndcg@20_pop: 0.0504    precision@20_pop: 0.0370    map@20_pop: 0.0269    
Thu 15 Jan 2026 22:30:02 INFO ██ DRAGON--Best validation results updated!!!
Thu 15 Jan 2026 22:36:55 INFO Epoch 3 training [time: 412.30s, Train loss: 151.1561]
Thu 15 Jan 2026 22:37:05 INFO Epoch 3: valid_score: 0.0835
Thu 15 Jan 2026 22:37:05 INFO Valid result: recall@20_pop: 0.0835    ndcg@20_pop: 0.0515    precision@20_pop: 0.0373    map@20_pop: 0.0274    
Thu 15 Jan 2026 22:37:05 INFO Test result : recall@20_pop: 0.0805    ndcg@20_pop: 0.0508    precision@20_pop: 0.0376    map@20_pop: 0.0273    
Thu 15 Jan 2026 22:37:05 INFO ██ DRAGON--Best validation results updated!!!
Thu 15 Jan 2026 22:43:57 INFO Epoch 4 training [time: 412.26s, Train loss: 145.7420]
Thu 15 Jan 2026 22:44:07 INFO Epoch 4: valid_score: 0.0713
Thu 15 Jan 2026 22:44:07 INFO Valid result: recall@20_pop: 0.0713    ndcg@20_pop: 0.0425    precision@20_pop: 0.0314    map@20_pop: 0.0210    
Thu 15 Jan 2026 22:44:07 INFO Test result : recall@20_pop: 0.0668    ndcg@20_pop: 0.0408    precision@20_pop: 0.0309    map@20_pop: 0.0204    
Thu 15 Jan 2026 22:50:59 INFO Epoch 5 training [time: 412.25s, Train loss: 141.7806]
Thu 15 Jan 2026 22:51:09 INFO Epoch 5: valid_score: 0.1031
Thu 15 Jan 2026 22:51:09 INFO Valid result: recall@20_pop: 0.1031    ndcg@20_pop: 0.0630    precision@20_pop: 0.0440    map@20_pop: 0.0336    
Thu 15 Jan 2026 22:51:09 INFO Test result : recall@20_pop: 0.0982    ndcg@20_pop: 0.0611    precision@20_pop: 0.0436    map@20_pop: 0.0325    
Thu 15 Jan 2026 22:51:09 INFO ██ DRAGON--Best validation results updated!!!
Thu 15 Jan 2026 22:58:01 INFO Epoch 6 training [time: 412.39s, Train loss: 138.3614]
Thu 15 Jan 2026 22:58:10 INFO Epoch 6: valid_score: 0.0882
Thu 15 Jan 2026 22:58:10 INFO Valid result: recall@20_pop: 0.0882    ndcg@20_pop: 0.0540    precision@20_pop: 0.0384    map@20_pop: 0.0286    
Thu 15 Jan 2026 22:58:10 INFO Test result : recall@20_pop: 0.0837    ndcg@20_pop: 0.0529    precision@20_pop: 0.0384    map@20_pop: 0.0285    
Thu 15 Jan 2026 23:05:02 INFO Epoch 7 training [time: 412.12s, Train loss: 135.9379]
Thu 15 Jan 2026 23:05:12 INFO Epoch 7: valid_score: 0.0959
Thu 15 Jan 2026 23:05:12 INFO Valid result: recall@20_pop: 0.0959    ndcg@20_pop: 0.0582    precision@20_pop: 0.0412    map@20_pop: 0.0305    
Thu 15 Jan 2026 23:05:12 INFO Test result : recall@20_pop: 0.0926    ndcg@20_pop: 0.0567    precision@20_pop: 0.0409    map@20_pop: 0.0295    
Thu 15 Jan 2026 23:12:33 INFO Epoch 8 training [time: 441.63s, Train loss: 133.2284]
Thu 15 Jan 2026 23:12:46 INFO Epoch 8: valid_score: 0.0833
Thu 15 Jan 2026 23:12:46 INFO Valid result: recall@20_pop: 0.0833    ndcg@20_pop: 0.0510    precision@20_pop: 0.0364    map@20_pop: 0.0266    
Thu 15 Jan 2026 23:12:46 INFO Test result : recall@20_pop: 0.0798    ndcg@20_pop: 0.0495    precision@20_pop: 0.0364    map@20_pop: 0.0259    
Thu 15 Jan 2026 23:20:13 INFO Epoch 9 training [time: 447.60s, Train loss: 131.6922]
Thu 15 Jan 2026 23:20:25 INFO Epoch 9: valid_score: 0.0841
Thu 15 Jan 2026 23:20:25 INFO Valid result: recall@20_pop: 0.0841    ndcg@20_pop: 0.0512    precision@20_pop: 0.0363    map@20_pop: 0.0267    
Thu 15 Jan 2026 23:20:25 INFO Test result : recall@20_pop: 0.0807    ndcg@20_pop: 0.0496    precision@20_pop: 0.0368    map@20_pop: 0.0254    
Thu 15 Jan 2026 23:27:52 INFO Epoch 10 training [time: 446.51s, Train loss: 129.6864]
Thu 15 Jan 2026 23:28:04 INFO Epoch 10: valid_score: 0.0970
Thu 15 Jan 2026 23:28:04 INFO Valid result: recall@20_pop: 0.0970    ndcg@20_pop: 0.0593    precision@20_pop: 0.0417    map@20_pop: 0.0313    
Thu 15 Jan 2026 23:28:04 INFO Test result : recall@20_pop: 0.0931    ndcg@20_pop: 0.0576    precision@20_pop: 0.0414    map@20_pop: 0.0302    
Thu 15 Jan 2026 23:35:17 INFO Epoch 11 training [time: 432.44s, Train loss: 128.1570]
Thu 15 Jan 2026 23:35:26 INFO Epoch 11: valid_score: 0.1018
Thu 15 Jan 2026 23:35:26 INFO Valid result: recall@20_pop: 0.1018    ndcg@20_pop: 0.0625    precision@20_pop: 0.0431    map@20_pop: 0.0332    
Thu 15 Jan 2026 23:35:26 INFO Test result : recall@20_pop: 0.0953    ndcg@20_pop: 0.0599    precision@20_pop: 0.0429    map@20_pop: 0.0319    
Thu 15 Jan 2026 23:42:18 INFO Epoch 12 training [time: 412.21s, Train loss: 126.2756]
Thu 15 Jan 2026 23:42:28 INFO Epoch 12: valid_score: 0.1085
Thu 15 Jan 2026 23:42:28 INFO Valid result: recall@20_pop: 0.1085    ndcg@20_pop: 0.0659    precision@20_pop: 0.0453    map@20_pop: 0.0349    
Thu 15 Jan 2026 23:42:28 INFO Test result : recall@20_pop: 0.1036    ndcg@20_pop: 0.0644    precision@20_pop: 0.0453    map@20_pop: 0.0343    
Thu 15 Jan 2026 23:42:28 INFO ██ DRAGON--Best validation results updated!!!
Thu 15 Jan 2026 23:49:20 INFO Epoch 13 training [time: 412.22s, Train loss: 124.8755]
Thu 15 Jan 2026 23:49:30 INFO Epoch 13: valid_score: 0.1055
Thu 15 Jan 2026 23:49:30 INFO Valid result: recall@20_pop: 0.1055    ndcg@20_pop: 0.0633    precision@20_pop: 0.0436    map@20_pop: 0.0331    
Thu 15 Jan 2026 23:49:30 INFO Test result : recall@20_pop: 0.0978    ndcg@20_pop: 0.0610    precision@20_pop: 0.0429    map@20_pop: 0.0326    
Thu 15 Jan 2026 23:56:23 INFO Epoch 14 training [time: 412.66s, Train loss: 123.4273]
Thu 15 Jan 2026 23:56:33 INFO Epoch 14: valid_score: 0.1033
Thu 15 Jan 2026 23:56:33 INFO Valid result: recall@20_pop: 0.1033    ndcg@20_pop: 0.0627    precision@20_pop: 0.0431    map@20_pop: 0.0330    
Thu 15 Jan 2026 23:56:33 INFO Test result : recall@20_pop: 0.0976    ndcg@20_pop: 0.0601    precision@20_pop: 0.0432    map@20_pop: 0.0311    
Fri 16 Jan 2026 00:03:25 INFO Epoch 15 training [time: 412.44s, Train loss: 122.1992]
Fri 16 Jan 2026 00:03:35 INFO Epoch 15: valid_score: 0.1126
Fri 16 Jan 2026 00:03:35 INFO Valid result: recall@20_pop: 0.1126    ndcg@20_pop: 0.0700    precision@20_pop: 0.0472    map@20_pop: 0.0379    
Fri 16 Jan 2026 00:03:35 INFO Test result : recall@20_pop: 0.1084    ndcg@20_pop: 0.0682    precision@20_pop: 0.0474    map@20_pop: 0.0367    
Fri 16 Jan 2026 00:03:35 INFO ██ DRAGON--Best validation results updated!!!
Fri 16 Jan 2026 00:10:28 INFO Epoch 16 training [time: 412.79s, Train loss: 120.9741]
Fri 16 Jan 2026 00:10:38 INFO Epoch 16: valid_score: 0.1289
Fri 16 Jan 2026 00:10:38 INFO Valid result: recall@20_pop: 0.1289    ndcg@20_pop: 0.0794    precision@20_pop: 0.0525    map@20_pop: 0.0431    
Fri 16 Jan 2026 00:10:38 INFO Test result : recall@20_pop: 0.1228    ndcg@20_pop: 0.0765    precision@20_pop: 0.0522    map@20_pop: 0.0411    
Fri 16 Jan 2026 00:10:38 INFO ██ DRAGON--Best validation results updated!!!
Fri 16 Jan 2026 00:17:30 INFO Epoch 17 training [time: 412.03s, Train loss: 119.9132]
Fri 16 Jan 2026 00:17:40 INFO Epoch 17: valid_score: 0.1051
Fri 16 Jan 2026 00:17:40 INFO Valid result: recall@20_pop: 0.1051    ndcg@20_pop: 0.0639    precision@20_pop: 0.0440    map@20_pop: 0.0335    
Fri 16 Jan 2026 00:17:40 INFO Test result : recall@20_pop: 0.0987    ndcg@20_pop: 0.0607    precision@20_pop: 0.0432    map@20_pop: 0.0318    
Fri 16 Jan 2026 00:24:33 INFO Epoch 18 training [time: 412.45s, Train loss: 118.9395]
Fri 16 Jan 2026 00:24:43 INFO Epoch 18: valid_score: 0.1083
Fri 16 Jan 2026 00:24:43 INFO Valid result: recall@20_pop: 0.1083    ndcg@20_pop: 0.0657    precision@20_pop: 0.0448    map@20_pop: 0.0344    
Fri 16 Jan 2026 00:24:43 INFO Test result : recall@20_pop: 0.1019    ndcg@20_pop: 0.0630    precision@20_pop: 0.0445    map@20_pop: 0.0326    
Fri 16 Jan 2026 00:31:36 INFO Epoch 19 training [time: 412.43s, Train loss: 117.6654]
Fri 16 Jan 2026 00:31:46 INFO Epoch 19: valid_score: 0.1046
Fri 16 Jan 2026 00:31:46 INFO Valid result: recall@20_pop: 0.1046    ndcg@20_pop: 0.0630    precision@20_pop: 0.0437    map@20_pop: 0.0325    
Fri 16 Jan 2026 00:31:46 INFO Test result : recall@20_pop: 0.0957    ndcg@20_pop: 0.0594    precision@20_pop: 0.0429    map@20_pop: 0.0310    
Fri 16 Jan 2026 00:38:39 INFO Epoch 20 training [time: 412.73s, Train loss: 116.4936]
Fri 16 Jan 2026 00:38:49 INFO Epoch 20: valid_score: 0.1030
Fri 16 Jan 2026 00:38:49 INFO Valid result: recall@20_pop: 0.1030    ndcg@20_pop: 0.0623    precision@20_pop: 0.0431    map@20_pop: 0.0320    
Fri 16 Jan 2026 00:38:49 INFO Test result : recall@20_pop: 0.0965    ndcg@20_pop: 0.0597    precision@20_pop: 0.0428    map@20_pop: 0.0309    
Fri 16 Jan 2026 00:45:42 INFO Epoch 21 training [time: 412.36s, Train loss: 115.7506]
Fri 16 Jan 2026 00:45:52 INFO Epoch 21: valid_score: 0.1148
Fri 16 Jan 2026 00:45:52 INFO Valid result: recall@20_pop: 0.1148    ndcg@20_pop: 0.0715    precision@20_pop: 0.0481    map@20_pop: 0.0386    
Fri 16 Jan 2026 00:45:52 INFO Test result : recall@20_pop: 0.1110    ndcg@20_pop: 0.0699    precision@20_pop: 0.0480    map@20_pop: 0.0377    
Fri 16 Jan 2026 00:52:45 INFO Epoch 22 training [time: 412.54s, Train loss: 114.7688]
Fri 16 Jan 2026 00:52:55 INFO Epoch 22: valid_score: 0.1160
Fri 16 Jan 2026 00:52:55 INFO Valid result: recall@20_pop: 0.1160    ndcg@20_pop: 0.0704    precision@20_pop: 0.0474    map@20_pop: 0.0369    
Fri 16 Jan 2026 00:52:55 INFO Test result : recall@20_pop: 0.1102    ndcg@20_pop: 0.0683    precision@20_pop: 0.0474    map@20_pop: 0.0360    
Fri 16 Jan 2026 00:59:48 INFO Epoch 23 training [time: 412.27s, Train loss: 113.6780]
Fri 16 Jan 2026 00:59:58 INFO Epoch 23: valid_score: 0.1111
Fri 16 Jan 2026 00:59:58 INFO Valid result: recall@20_pop: 0.1111    ndcg@20_pop: 0.0673    precision@20_pop: 0.0454    map@20_pop: 0.0348    
Fri 16 Jan 2026 00:59:58 INFO Test result : recall@20_pop: 0.1056    ndcg@20_pop: 0.0654    precision@20_pop: 0.0455    map@20_pop: 0.0342    
Fri 16 Jan 2026 01:06:51 INFO Epoch 24 training [time: 412.53s, Train loss: 112.8918]
Fri 16 Jan 2026 01:07:01 INFO Epoch 24: valid_score: 0.1248
Fri 16 Jan 2026 01:07:01 INFO Valid result: recall@20_pop: 0.1248    ndcg@20_pop: 0.0762    precision@20_pop: 0.0509    map@20_pop: 0.0405    
Fri 16 Jan 2026 01:07:01 INFO Test result : recall@20_pop: 0.1188    ndcg@20_pop: 0.0738    precision@20_pop: 0.0512    map@20_pop: 0.0393    
Fri 16 Jan 2026 01:13:54 INFO Epoch 25 training [time: 412.34s, Train loss: 111.8473]
Fri 16 Jan 2026 01:14:04 INFO Epoch 25: valid_score: 0.1021
Fri 16 Jan 2026 01:14:04 INFO Valid result: recall@20_pop: 0.1021    ndcg@20_pop: 0.0620    precision@20_pop: 0.0432    map@20_pop: 0.0322    
Fri 16 Jan 2026 01:14:04 INFO Test result : recall@20_pop: 0.0966    ndcg@20_pop: 0.0601    precision@20_pop: 0.0432    map@20_pop: 0.0314    
Fri 16 Jan 2026 01:20:56 INFO Epoch 26 training [time: 412.65s, Train loss: 111.2484]
Fri 16 Jan 2026 01:21:06 INFO Epoch 26: valid_score: 0.1260
Fri 16 Jan 2026 01:21:06 INFO Valid result: recall@20_pop: 0.1260    ndcg@20_pop: 0.0768    precision@20_pop: 0.0509    map@20_pop: 0.0403    
Fri 16 Jan 2026 01:21:06 INFO Test result : recall@20_pop: 0.1197    ndcg@20_pop: 0.0743    precision@20_pop: 0.0507    map@20_pop: 0.0391    
